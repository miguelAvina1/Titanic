# Inteligent Systems: Titanic Homewok.
#
# Authors:  Miguel Avina
#           Arturo Perez
# Date:     04/26/2020

# Importing files, code generated by RStudio "Import Dataset" tool.
library(readr)

train_data <- read_csv("data/train.csv")
test_data  <- read_csv("data/test.csv")

n_var = ncol(train_data)  # Getting number of variables (same as columns)
sprintf("Number of variables of train data: %s", n_var)

n_numeric = 0
n_categorical = 0
for (column in colnames(train_data)) {
  if (class(train_data[[column]]) == "numeric") {
    n_numeric = n_numeric + 1
  } else {
    n_categorical = n_categorical + 1
  }
}
sprintf("No. of categorical variables: %s", n_categorical)
sprintf("No. of numerical variables %s", n_numeric)

str(train_data)  # Brief string representation of the data

# Removing:
# PassengerId: 1-891 series, not related to passenger
# Name: Altough we can correlate last names with travel classes or relationships between passengers, 
#       this will suppose great effort that may not be worth for the scope of this study.
# Ticket: This variable doen't give any relevan information.
# Embarked: All passengers were inside the ship at the crash. This is irrelevant.
library(dplyr)
train_data <- select(train_data, -PassengerId, -Name, -Ticket, -Embarked)

# Checking for missing data and storing the info.
# Creating the empty table to store the info:
missing_data = matrix(data = 0, nrow = ncol(train_data), ncol = 3)
colnames(missing_data) <- c("Variable", "Occurrences", "Percentage")

missing_data[1:8, 1] <- colnames(train_data)
i = 1
for (column in train_data) {
    missing_data[i, 2] <- sum(is.na(column))
    missing_data[i, 3] <- round(mean(is.na(column))*100, digits = 2)  
    i = i + 1
}
row_sub = apply(missing_data, 1, function(row) all(row !=0 )) # Checkig for zeros in rows
missing_data = missing_data[row_sub,]                         # Subset

print("Missing data summary:")
print(missing_data)

